import{a9 as E,r as j,a3 as y,ac as z,j as e,C as V,ad as k,ab as x,L as D,Z as d,ae as F,W as C,a5 as m}from"./index-7609e3f1.js";import{a as O,p as R,b as I}from"./serviceContext-c100fc54.js";import{i as P,f as L}from"./validateInput-7dfdef26.js";function $(){var g,S,h,b;const u=E(),[T,p]=j.useState(!1),{handleSubmit:N,register:l,setValue:c,formState:{errors:a}}=y(),{idServico:o}=z();j.useEffect(()=>{async function r(){var s,v,f,n,t;if(console.log(o),o!=null&&o!=null){p(!1);try{const i=await O(o),q=(s=i.data)==null?void 0:s.preco.toFixed(2).replace(".",",");c("nomeServico",(v=i.data)==null?void 0:v.nomeServico),c("preco",q),c("categoria",(f=i.data)==null?void 0:f.preco),c("qtdTempoServico",(n=i.data)==null?void 0:n.qtdTempoServico),c("descricao",(t=i.data)==null?void 0:t.descricao),console.log(i),p(!0)}catch(i){p(!0),console.error("Erro ao buscar serviços:",i)}}p(!0)}r()},[]);const w=async r=>{let s=r.qtdTempoServico;o==null&&o==null&&(s+=":00");const v=String(r.preco),f=parseFloat(v.replace(/[^\d.,]/g,"").replace(",",".")),n={categoria:r.categoria,nomeServico:r.nomeServico.trim(),preco:f,descricao:r.descricao.trim(),qtdTempoServico:s};if(o==null&&o==null)try{await R(n),m.fire("Sucess","Sucesso ao criar o serviço.","success"),x(u,-1),console.log(response)}catch(t){console.error("Erro ao criar o serviço:",t),m.fire("Erro","Erro ao criar o serviço.","error")}else if(o!=null&&o!=null)try{await I(n,o),m.fire("Sucess","Sucesso ao atualizar o serviço.","success"),x(u,-1)}catch(t){console.error("Erro ao atualizar o serviço:",t),m.fire("Erro","Erro ao atualizar o serviço.","error")}},B=()=>{m.fire({title:"Tem certeza que deseja cancelar esse serviço?",icon:"warning",showCancelButton:!0,cancelButtonText:"Não",cancelButtonColor:"#dc3545",confirmButtonText:"Sim, Tenho!",confirmButtonColor:"#2f9c7f",reverseButtons:!0,width:450}).then(r=>{r.isConfirmed&&x(u,-1)})};return e.jsx(e.Fragment,{children:e.jsx(V,{className:"h-full m-5 p-6",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx(k,{onClick:()=>x(u,-1),underline:"hover",className:"cursor-pointer",children:"Voltar"}),e.jsxs("form",{className:"max-w-screen-lg text-center flex flex-col gap-12",onSubmit:N(w),children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Serviço"}),T?e.jsxs("div",{className:"w-full flex flex-col gap-8",children:[e.jsxs("div",{className:"w-full flex flex-col gap-12",children:[e.jsx(d,{id:"outlined-basic",label:"Nome",variant:"outlined",className:"",placeholder:"Digite o nome do Serviço",size:"small",...l("nomeServico",{required:"Campo é Obrigatório"}),error:!!a.nomeServico,helperText:(g=a.nomeServico)==null?void 0:g.message}),e.jsxs("div",{className:"flex gap-6 w-full",children:[e.jsx(F,{mask:"R$ 999,99",maskChar:"0",defaultValue:"",...l("preco",{required:"Campo é Obrigatório"}),children:r=>{var s;return e.jsx(d,{...r,className:"w-1/2",id:"outlined-basic",label:"Valor",variant:"outlined",placeholder:"Digite o valor do Serviço",size:"small",error:!!a.preco,helperText:(s=a.preco)==null?void 0:s.message})}}),e.jsx(d,{className:"w-1/2",id:"outlined-basic",label:"Tempo",variant:"outlined",placeholder:"Digite o tempo do serviço",defaultValue:"00:00:00",size:"small",...l("qtdTempoServico",{required:"Campo é Obrigatório"}),onInput:r=>{P(r),L(r)},error:!!a.qtdTempoServico,helperText:(S=a.qtdTempoServico)==null?void 0:S.message})]}),e.jsx(d,{id:"outlined-basic",label:"Categoria",variant:"outlined",multiline:!0,size:"small",placeholder:"Descreva o Serviço",...l("categoria",{required:"Campo é Obrigatório"}),error:!!a.categoria,helperText:(h=a.categoria)==null?void 0:h.message}),e.jsx(d,{id:"outlined-basic",label:"Descrição",variant:"outlined",multiline:!0,size:"small",rows:8,placeholder:"Descreva o Serviço",...l("descricao",{required:"Campo é Obrigatório"}),error:!!a.descricao,helperText:(b=a.descricao)==null?void 0:b.message})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(C,{className:"w-48",variant:"outlined",onClick:B,children:"Cancelar"}),e.jsx(C,{className:"w-48",variant:"contained",type:"submit",children:"Cadastrar Serviço"})]})]}):e.jsx(D,{})]})]})})})}export{$ as default};
